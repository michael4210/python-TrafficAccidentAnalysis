{% extends "base.html" %}

{% block title %}9: 高雄市交通事故條件分析{% endblock %}

{% block headmessage %}
<h3>高雄市交通事故條件分析</h3>
{% endblock %}

{% block content %}
  {% for condition, casualties in condition_casualties.items %}
    <div>
      {% if condition == "weather_desc" %}
        <h2 style = "text-align: center;">天氣因素</h2>
      {% endif %}
      {% if condition == "light_desc" %}
        <h2 style = "text-align: center; padding-top: 50px;">光線因素</h2>
      {% endif %}
      {% if condition == "road_surface_condition_desc" %}
        <h2 style = "text-align: center; padding-top: 50px;">地面因素</h2>
      {% endif %}
      {% if condition == "road_type_desc" %}
        <h2 style = "text-align: center; padding-top: 50px;">路面因素</h2>
      {% endif %}
      {% if condition == "traffic_sign_desc" %}
        <h2 style = "text-align: center; padding-top: 50px;">號誌因素</h2>
      {% endif %}
      <canvas id = "myChart" width = "800", height = "300"></canvas>
    </div>
    <script>
      const ctx = document.getElementById('myChart');

      new Chart(ctx, {
        type: 'bar', 
        data: {
          labels: [
            {% for casualty in casualties %}
              '{{ casualty.0 }}',
            {% endfor %}
          ], 
          datasets: [{
            label: 'Numbers of the type of accident', 
            data: [
              {% for casualty in casualties %}
                {{ casualty.1 }},
              {% endfor %}
            ], 
            borderWidth: 1
          }]
        }, 
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    </script>
  {% endfor %}
  

    <!-- {% for condition, casualties in condition_casualties.items %}
    <h3>{{ condition }}</h3>
    <table>
      <tr>
        <th>Condition</th>
        <th>Total Casualties</th>
      </tr>
      {% for casualty in casualties %}
      <tr>
        <td>{{ casualty.0 }}</td>-
        <td>{{ casualty.1 }}</td>
      </tr>
      {% endfor %}
    </table>
    {% endfor %}
{% comment %}
<h1>Conditions Analysis</h1>
{% for condition, casualties in condition_casualties.items %}
<h2>{{ condition }}</h2>
<table>
  <tr>
    <th>Condition</th>
    <th>Total Casualties</th>
  </tr>
  {% for casualty in casualties %}
  <tr>
    <td>{{ casualty.condition}}</td>
    <td>{{ casualty.total_casualties }}</td>
  </tr>
  {% endfor %}
</table>
{% endfor %} {% endcomment %} -->
{% endblock %}